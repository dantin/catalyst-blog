+++
categories = ["Scholar"]
tags = ["Java", "JVM"]
date = "2017-02-08T15:08:13+08:00"
title = "JVM中整数的表示"
description = "JVM中整数的表示"
slug = "java-jvm-integer"
+++

JVM中整数有`byte`、`short`、`int`、`long`四种，分别表示8位、16位、32位、64位的有符号整数。

整数在计算机中使用补码表示，本文阐述补码的表示方法。

### 原码

所谓原码，就是符号位加上数字的二进制表示。

以`int`为例，第1位表示符号位，其余31位表示该数字的二进制值。

`10`的原码为：`00000000 00000000 00000000 00001010`
`-10`的原码为：`10000000 00000000 00000000 00001010`

对于原码来说，绝对值相同的正数和负数只有符号位不同。

### 反码

反码，就是在原码的基础上，符号位不变，其余位取反。

以`-10`为例，反码为：`11111111 11111111 11111111 11110101`

### 补码

负数的补码就是反码加1，正数的补码就是原码本身。

`10`的补码为：`00000000 00000000 00000000 00001010`
`-10`的补码为：`11111111 11111111 11111111 11110110`

使用位运算查看整数表示：

思路：进行32次循环（`int`共有32位），每次取最左边的1位（通过`0x80000000`，即首位为1其余为0的整数，右移i位，定位要获取的第i位），然后再将该位移到最右，进行输出。

```java
public String bitPattern(int n) {
    StringBuilder buf = new StringBuilder();

    for (int i = 0; i < 32; i++) {
        int t = (n & 0x80_00_00_00 >>> i) >>> (31 - i);
        buf.append(t);
    }
    return buf.toString();
}
```

补码的优点：

1. 统一数字0的表示；
    ```console
    # 若0为正数，补码为原码本身：
    0000 0000

    # 若0为负数，补码为反码加1
    # 负数0的原码：
    1000 0000
    # 反码：
    1111 1111
    # 补码为反码加1
    0000 0000
    ```
2. 简化整数的加减法运算，减法和加法统一、正数和负数加法的统一。
    ```console
    # -6 + 5的计算过程：

    # -6的补码
    1111 1010
    # 5的补码
    0000 0101
    # Add
    1111 1111
    # 即：-1

    # 4 + 6的计算过程

    # 4的补码
    0000 0100
    # 6的补码
    0000 0110
    # Add
    0000 1010
    # 即：10
    ```

